**集群是个物理形态，分布式是个工作方式。**

- 分布式(distributed)：是指在多台`不同的服务器`中部署`不同的服务模块`，通过远程调用协同工作，对外提供服务。

  分布式的每一个节点都可以做集群。而集群并不一定就是分布式的。


- 集群（cluster）是指在多台`不同的服务器`中部署`相同应用或服务模块`，构成一个集群，通过负载均衡设备对外提供服务。

  一台服务器垮掉了，其他服务器可以顶上来。分布式的每一个节点都完成不同的任务，一个节点（服务模块）垮了，这个业务就不能访问了。

  分布式是以缩短单个任务的执行时间来提升效率的，而集群则是通过提高单位时间内执行的任务数来提升效率。

  举个栗子：
  一个任务由 10 个子任务组成，每个子任务单独执行需 1 小时，则在一台服务器上执行该任务需 10 小时。
  分布式方案：提供 10 台服务器，每台服务器只负责处理一个子任务，执行完这个任务只需一个小时。
  集群方案：同样提供 10 台服务器，每台服务器都能独立处理这个任务。10 个服务器将同时工作，1小时后，10个任务同时完成。

  分布式和集群结合，**先分布式再集群**。业务拆分成子业务，针对每个子业务做负载均衡。

- 微服务是一种架构风格，系统中的各个微服务可被独立部署，各个微服务之间是松耦合的。`分布式属于微服务`。


分布式注意事项：
1. 微服务架构的分布式事务解决方案。
2. 分布式存储
3. 分布式事物
4. CAP理论


集群注意事项：session共享，确保在不同服务器的切换中没有获取到session。


::: tip
使用分布式锁的目的，就是保证同一时间只有一个客户端访问共享资源。
:::


分布式锁的正确实现方式
- 基于数据库乐观锁（悲观锁，乐观锁）
- 基于zookeeper的分布式锁
- 数据库乐观锁
- 基于缓存的分布式锁

基于缓存的好处：缓存一般都是集群部署的


## 分布式锁和普通的锁的区别？

::: warning
分布式锁，是控制分布式系统之间同步访问共享资源的一种方式。在分布式系统中，常常需要协调他们的动作。如果不同的系统或是同一个系统的不同主机之间共享了一个或一组资源，那么访问这些资源的时候，往往需要互斥来防止彼此干扰来保证一致性，在这种情况下，便需要使用到分布式锁。
:::

分布式锁保证分布式部署的应用集群中，同一个方法在同一时刻只能被一台机器上的一个线程执行



什么时候使用分布式锁?
分布式的情况，多进程多线程，jvm控制不了，java自带的锁就会实现不了并发功能了。
使用其他工具控制，Redis，天生单线程

什么时候使用普通的锁就可以？
单机情况下使用`Syncronized`或者`Lock`实现锁机制。单进程多线程实现同步每问题


JVM锁和分布式锁
https://blog.csdn.net/ym123456677/article/details/80325536
https://blog.csdn.net/gupaoxueyuan/article/details/78825313
https://www.cnblogs.com/dennyzhangdd/p/7133653.html


## 什么是分布式的CAP理论
::: tip CAP
一致性（Consistency）可用性（Availability）分区容错性（Partition tolerance）
:::


## 分布式场景要解决的问题

- 数据的一致性（分布式事务，分布式锁）
-


分布式Session解决方案？也就是Session共享的问题？

限流，熔断等


首先，关于分布式，有些纯理论的知识需要开发有个基本的概念：

1、什么是分布式，什么是集群，二者有什么区别？
2、分布式的CAP理论、BASE理论？
3、什么是分布式的数据一致性？
4、2PC、3PC、TCC等

画重点：这部分的理论要有些基本的掌握，`至少CAP要知道`，包括CAP的证明等。

还有就是和分布式相关的一些工具、框架、中间件等，如：

1、消息队列：Kafka、ActiveMQ、RabbitMQ、RocketMQ
2、RPC框架：Dubbo、gRPC
3、分布式缓存：Redis、Memcached
4、分布式搜索：elasticsearch
5、分布式协调：Zookeeper

还有就是一些分布式问题的解决方案：

1、分布式事务
2、分布式锁
3、分库分表
4、限流、降级

项目中用到了分布式缓存，是你做的选型吗？
Redis和memcached有什么区别？为什么选某一个？
如果让你重新选一次还这么选吗？
知道用Redis如何实现分布式锁吗？
Redis实现的分布式锁有什么缺点吗？
分布式锁解决什么问题呢？
除了Redis还有什么方式可以实现分布式锁？
Zookeeper实现分布式锁的原理是什么？
Zookeeper和Redis实现的分布式锁优缺点如何？
使用数据库可以实现分布式锁吗？

## 分布式与微服务
分布式，服务是分散部署在不同的机器上。

微服务架构是分布式服务架构的子集。